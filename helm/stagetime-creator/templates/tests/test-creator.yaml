---
apiVersion: v1
kind: Pod
metadata:
  name: stagetime-creator-smoketest
  annotations:
    "helm.sh/hook": test
spec:
  serviceAccountName: stagetime-creator
  initContainers:
    - name: test-producer
      image: scr.cd43.sthings-pve.labul.sva.de/stagetime-creator/stagetime-creator:23.1129.1048-v0.1.71
      command: ['stcTestProducer']
      env:
        - name: REDIS_STREAM
          value: "stagetime:test-manifests"
      envFrom:
        - secretRef:
            name: redis-connection
  containers:
    - name: test-consumer
      image: scr.cd43.sthings-pve.labul.sva.de/stagetime-creator/stagetime-creator:23.1129.1048-v0.1.71
      command: ['stcTestConsumer']
      env:
        - name: REDIS_STREAM
          value: "stagetime:test-manifests"
      envFrom:
        - secretRef:
            name: redis-connection
  restartPolicy: Never
